<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plonesurvey">
<body>
<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
        tal:define="errors options/state/getErrors;
                    member_id context/getSurveyId;
                    questions context/getQuestions;
                    completed python:here.checkCompletedFor(member_id);
                    show_captcha context/getShowCaptcha|nothing;
                    qi_tool context/portal_quickinstaller;
                    captcha_prod string:quintagroup.plonecaptchas;
                    captcha_installed python:qi_tool.isProductInstalled(captcha_prod);
                    isAnon context/@@plone_portal_state/anonymous;
                    pagetype context/portal_type;
                    survey_tool context/plone_survey_tool;">

        <div tal:replace="structure provider:plone.abovecontenttitle" />

	Now you can print the survey. <a href="mostra_quest?print_type=html">Show the report to print</a> or <a href="mostra_quest?type=pdf">Download the report in pdf format</a>
<hr />
<h2>Here the answers you submitted:</h2>
<hr />
        <form name="edit_form"
              method="post"
              tal:attributes="action template/id"
              tal:condition="python:completed">
            <input type="hidden" name="form.submitted" value="1" />
            <input type="hidden" name="came_from"
                   tal:attributes="value request/came_from | nothing"
                   tal:condition="request/came_from | nothing" />
            <input type="hidden" name="survey_user_id"
                   tal:attributes="value context/getSurveyId" />
            <fieldset>
                <legend tal:condition="completed" i18n:translate="legend_report_completed">Report</legend>
                <legend tal:condition="python:here.getId() == 'summary' and not(completed)" i18n:translate="legend_summary_completed">Survey data summary:</legend>
                <div tal:define="questions here/getAllQuestionsInOrder"
                     tal:repeat="question questions">

                 <div tal:omit-tag="" tal:condition="python: not('noreport' in question.Subject())">

                 <tal:condition condition="python:question.meta_type == 'SurveyMatrixQuestion'">
                    <div metal:use-macro="here/question_matrix_macro/macros/display" />
                 </tal:condition>
		 <tal:condition condition="python:question.meta_type <> 'SurveyGridQuestion' and question.meta_type <> 'SurveyMatrixQuestion' ">
                    <div metal:use-macro="here/question_macro/macros/display" />
		</tal:condition>
                 <tal:condition condition="python:question.meta_type == 'SurveyGridQuestion'">
                    <div metal:use-macro="here/question_grid_macro/macros/display" />
                </tal:condition>

                 </div>
                </div>
                <div class="formControls">
                    <input class="context"
                           type="submit"
                           value="Reset Survey"
                           name="form.button.reset_survey"
                           i18n:attributes="value reset_survey_button"
                           tal:condition="python:user.has_permission('PloneSurvey: Reset Own Responses', here) and completed" />
                </div>
            </fieldset>
        </form>
    </tal:main-macro>
</metal:main>
</body>
</html>
